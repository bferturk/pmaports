# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=ubuntu-ui-toolkit
pkgver=0_git20190422
_commit="d19600f2e7690aaf5f49c88174b541aeab7bc7ef"
pkgrel=0
pkgdesc='The Ubuntu UI toolkit used in Ubuntu Touch'
arch="all"
url="https://unity8.io"
license="LGPL-3.0"
depends="qt5-qtfeedback"
depends_dev="libnih-dev qt5-qtsvg-dev qt5-qtpim-dev qt5-qtsystems-dev lttng-ust-dev libxi-dev eudev-dev mir-dev libevdev-dev qt5-qtgraphicaleffects qt5-qtfeedback-dev"
makedepends="$depends_dev qt5-qttools-dev qt5-qtdeclarative-dev"
source="$pkgname-$_commit.tar.gz::https://github.com/ubports/$pkgname/archive/$_commit.tar.gz
	0004-Make-it-compile-with-Qt-5.12.patch
	replace-bash-for-sh.patch"
subpackages="$pkgname-dev $pkgname-lang"
options="!check" # Complaining about a non-existing file
builddir="$srcdir/$pkgname-$_commit"

prepare() {
	default_prepare

	# Lets warnings be warnings and not errors
	sed -i 's|warning_clean|warn_off|' "$builddir"/.qmake.conf
}

build() {
	cd "$builddir"
	qmake-qt5 "CONFIG+=no_docs"
	make
}

check() {
	cd "$builddir"
	make check
}

package() {
	cd "$builddir"
	make INSTALL_ROOT="$pkgdir" install
}

sha512sums="99e333e51653b810c14d2918f89421ac52d8d845010c4671d33c302f5990e796446c03e517c8ea5cd39d951bb378eaa1a4c3654f27850c6aaaf1d0134dc684bd  ubuntu-ui-toolkit-d19600f2e7690aaf5f49c88174b541aeab7bc7ef.tar.gz
5b5c00bd365ee4068e2e0622a0ce31c7b67b0c6cf136b0d717dd68ac9559bc2d9c54e1e0c9106fa1d6e3438de974fa8b44c023888fe87bc1d1ed584023184eba  0004-Make-it-compile-with-Qt-5.12.patch
e01567f2426f78b0862e7b09cd99cabf3d885b600592e6a4f0e07dc077fae2ba8dd1d2deba3bb89d31171a90db6de909281664bcbc7736b9432f2bc0b26544e1  replace-bash-for-sh.patch"
