# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=openauto
pkgver=0_git20180914
pkgrel=0
_commit="6dc394c11f1a0b09ccb0c5ca90012cd185baebca"
pkgdesc="AndroidAuto headunit emulator"
url="https://github.com/f1xpl/openauto"
arch="all"
license="none"
depends=""
makedepends="cmake qt5-qtbase-dev qt5-qtmultimedia-dev qt5-qtconnectivity-dev boost-dev protobuf-dev rtaudio-dev libusb-dev aasdk-dev aasdk"
source="
	$pkgname-$_commit.tar.gz::https://github.com/f1xpl/$pkgname/archive/$_commit.tar.gz
	libusb-errorcode.patch
"
builddir="$srcdir/$pkgname-$_commit"
options="!check"

build() {
	cd "$builddir"
	cmake \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_SKIP_RPATH=TRUE \
		-DAASDK_INCLUDE_DIRS="/usr/share/include" \
		-DAASDK_LIBRARIES="/usr/lib/libaasdk.so" \
		-DAASDK_PROTO_LIBRARIES="/usr/lib/libaasdk_proto.so" \
		-DAASDK_PROTO_INCLUDE_DIRS="/usr/share/include/aasdk_proto"
	make
}

package() {
	cd "$builddir"
	mkdir -p "$pkgdir"/usr/bin
	mv "$builddir"/bin/* "$pkgdir"/usr/bin
}

sha512sums="cc3b03a0679e4dd37d7ef84b87365720fc5b80be054fcc3c7d4bffabda3126db3849e854e06c1d144146319c4c4aabac6a444777eee2b60765e05a1e99bc7ec9  openauto-6dc394c11f1a0b09ccb0c5ca90012cd185baebca.tar.gz
03cf6b4b1e0e9d110f05ebd9b2c8c235fa9343bdd95e4b8f37c647ba0f2c9d991dd76c27875973d1ad2a4104f38f9cbf27dd57343140c01997a63f95b3b85414  libusb-errorcode.patch"
